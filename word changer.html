<html>

<head>
    <style>
        #butss {
            margin-left: 50%;
            width: 100px;
            height: 100px;
        }
    </style>
</head>

<body>
    <button onclick="doits()" id="butss">do it</button>

    <br>
    <p>javascript</p>
    <div>////////////////////////////////////////////</div>
    <div id="javascriptcode"></div>
    <br>
    <div id="htmlcode"></div>
    <script>

        var js = document.getElementById('javascriptcode')
        var htmlc = document.getElementById('htmlcode')

        var noofsongs = localStorage.getItem("noofsongs");
        noofsongs = parseInt(noofsongs)
        noofsongs = noofsongs + 1

        function doits() {
            var i = 0
            var full_with_space = "";

            var songtitle = prompt('Song Title');
            var songid;
            var track = "";
            var artist = "";


            var arrayofnames = songtitle.split(" ")
            var artistposition;
            for (i = 0; i < arrayofnames.length; i++) {
                if (arrayofnames[i] == "-") {
                    var artistposition = i
                }
            }

            for (i = 0; i < arrayofnames.length; i++) {
                if (artistposition == i) {
                    continue
                }
                else {
                    if (i == arrayofnames.length - 1) {
                        full_with_space = full_with_space + arrayofnames[i]
                    }
                    else {
                        full_with_space = full_with_space + arrayofnames[i] + " "
                    }
                }
            }
            var dashed_song_name = full_with_space.replace(/ /g, "-");
            console.log(dashed_song_name)


            const array_for_id = full_with_space.split("");
            songid = array_for_id[0];
            for (i = 0; i < array_for_id.length; i++) {
                if (array_for_id[i] == " ") {
                    songid = songid + array_for_id[i + 1]
                }

            }
            console.log(songid)

            var title_done = "false"
            for (i = 0; i < arrayofnames.length; i++) {
                if (arrayofnames[i] == "-") {
                    title_done = "true"
                }
                else if (title_done == "false") {
                    if (i == arrayofnames.length - 1) {
                        track = track + arrayofnames[i]
                    }
                    else{
                        track = track + arrayofnames[i] + " "
                    }
                }
                else if (title_done = "true") {
                    if (i == arrayofnames.length - 1) {
                        artist = artist + arrayofnames[i]
                    }
                    else {
                        artist = artist + arrayofnames[i] + " "
                    }
                }
            }
            console.log(track)
            console.log(artist)

            // javascript generator

            line1 = 'var p' + noofsongs + ' =document.getElementById("t' + noofsongs + '")'
            line2 = 'document.querySelector(".' + dashed_song_name + '").addEventListener("click", () => {'
            line3 = 'p' + noofsongs + '.play();'
            line4 = 'p' + noofsongs + '.currentTime = 0;'
            line5 = 'mcplay.style.visibility = "hidden";'
            line6 = 'mcpause.style.visibility = "visible";'
            line7 = 'mindiv.innerHTML = "0:";'
            line8 = 'secdiv.innerHTML = "00";'
            line9 = 'minuter = 0;'
            line10 = 'secondr = 1;'
            line11 = '});'

            var arr = [line1, line2, line3, line4, line5, line6, line7, line8, line9, line10, line11]

            for (i = 0; i < 11; i++) {
                var p = document.createElement('div')
                p.textContent = arr[i]
                js.appendChild(p)
            }


            // HTML generator

            hline1 = '<div class="' + dashed_song_name + ' title">'
            hline2 = '<p class="sname"><span id="songnamemain">' + track + '</span><br><span class="artist">' + artist + '</span></p>'
            hline3 = '<audio id="t' + noofsongs + '" class="audio-element" data-file-artist="' + artist + '" data-file-name="' + track + '" song-id="' + songid + '">'
            hline4 = '<source src="music/' + songtitle + '.opus" type="audio/mpeg">'
            hline5 = '</audio>'
            hline6 = '</div>'


            var harr = [hline1, hline2, hline3, hline4, hline5, hline6]

            for (i = 0; i < 7; i++) {
                var p = document.createElement('div')
                p.textContent = harr[i]
                htmlc.appendChild(p)
            }


            localStorage.setItem("noofsongs",noofsongs)
        }
    </script>
</body>

</html>